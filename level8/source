#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdbool.h>

int *auth;
char *service;

int main(void)
{
	char read_buf[5];
	char buf_2[2];
	char buf_125[125];

	while (1)
	{
		printf("%p, %p \n", auth, service);
		if (fgets((char *)read_buf, 128, stdin) == 0)
			return (0);
		if (strncmp(read_buf, "auth ", 5))
		{
			auth = malloc(1 * sizeof(int));
			*auth = 0;
			if (strlen(buf_2) < 31)
				strcpy((char *)auth, buf_2);
		}
		if (strncmp(read_buf, "reset", 5))
			if (auth)
				free(auth);
		if (strncmp(read_buf, "service", 6))
			service = strdup(buf_125);
		if (strncmp(read_buf, "login", 5)) {
			if (auth[8] == 0)
				fwrite("Password:\n", 1, 10, stdout);
			else
				system("/bin/sh");
		}
	}
}
